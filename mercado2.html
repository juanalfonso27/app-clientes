<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cotações em Tempo Real</title>

    <style>
        body {
            font-family: Arial, sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }

        .box {
            width: 430px;
            background: #fff;
            border: 1px solid #ccc;
            border-top: none;
        }

        .box-title {
            background: #333;
            padding: 10px;
            color: #fff;
            font-weight: bold;
            font-size: 16px;
            text-align: center;
            border-radius: 3px 3px 0 0;
        }

        .tabs {
            display: flex;
            border-bottom: 2px solid #e5e5e5;
        }

        .tab {
            flex: 1;
            text-align: center;
            padding: 10px;
            font-weight: bold;
            cursor: pointer;
            background: #fafafa;
        }

        .tab.active {
            border-bottom: 3px solid orange;
            background: #fff;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 14px;
        }

        th {
            background: #f2f2f2;
            padding: 8px;
            border-bottom: 1px solid #ccc;
        }

        td {
            padding: 8px;
            border-bottom: 1px solid #eee;
        }

        .up { color: #028a0f; font-weight: bold; }
        .down { color: #d00000; font-weight: bold; }

        .footer-note {
            text-align: center;
            font-size: 12px;
            padding: 10px;
            color: #555;
        }

        .footer-img {
            text-align: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
        }
    </style>
</head>
<body>

    <div class="box">

        <div class="box-title">COTAÇÕES EM TEMPO REAL</div>

        <div class="tabs">
            <div class="tab active">Commodities</div>
            <div class="tab">Índices</div>
        </div>

        <table>
            <thead>
                <tr>
                    <th style="text-align:left;">Contrato</th>
                    <th>Último</th>
                    <th>Var. %</th>
                </tr>
            </thead>
            <tbody id="cotacoes-body">
                <tr><td colspan="3" style="text-align:center;">Carregando...</td></tr>
            </tbody>
        </table>

        <div class="footer-note">
            Commodities fornecidas por br.investing.com
        </div>

        <div class="footer-img">
            <img src="https://i.imgur.com/h5vIM4c.png" width="110">
        </div>

    </div>


<script>
async function obterCotacoes() {
    try {
        const res = await fetch("http://localhost:3000/api/cotacoes");
        const dados = await res.json();

        const tbody = document.getElementById("cotacoes-body");
        tbody.innerHTML = "";

        dados.forEach(item => {
            const tr = document.createElement("tr");

            let classeVar =
                item.variacao.includes("+") ? "up" :
                item.variacao.includes("-") ? "down" : "";

            tr.innerHTML = `
                <td>${item.contrato}</td>
                <td style="text-align:center;">${item.ultimo}</td>
                <td style="text-align:center;" class="${classeVar}">${item.variacao}</td>
            `;

            tbody.appendChild(tr);
        });

    } catch (e) {
        document.getElementById("cotacoes-body").innerHTML =
            `<tr><td colspan="3" style="text-align:center;color:red;">Erro ao carregar dados</td></tr>`;
    }
}

obterCotacoes();
setInterval(obterCotacoes, 30000); // Atualiza a cada 30s
</script>

</body>
</html>
